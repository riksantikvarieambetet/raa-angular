<div #raaSelect class="raa-select">
  <div class="raa-select-input-row" [ngClass]="{ disabled: disabled }">
    <input
      [id]="inputElementID"
      class="raa-input raa-select-input z-index-0"
      #inputField
      type="text"
      autocomplete="off"
      role="combobox"
      [attr.aria-activedescendant]="activeItem?.id"
      aria-autocomplete="list"
      aria-expanded="false"
      aria-haspopup="true"
      aria-owns="raa-dropdown"
      [placeholder]="placeholder"
      [requestFocus]="setFocusToInputField"
      [disabled]="disabled"
      [ngModelOptions]="{ standalone: true }"
      [(ngModel)]="filterInput"
      (ngModelChange)="onFilteredInputChange()"
      (focus)="focusGained()"
      (click)="openDropdownIfClosed()"
      (keydown)="handleKeyPressed($event)"
    />
    <button
      class="raa-select-button raa-icon-arrow-down"
      type="button"
      tabIndex="0"
      [disabled]="disabled"
      (click)="toggleDropdown()"
      [ngClass]="{ 'active z-index-2': showDropdown }"
    >
      <span class="tw-hidden">Expandera</span>
    </button>
  </div>

  <raa-dropdown
    *ngIf="showDropdown"
    [element]="raaSelect"
    (dropdownMovedUp)="dropdownMovedUp($event)"
    [moveUpHeightThreshold]="120"
    appendToBody="{{ false }}"
  >
    <ul
      #dropdown
      id="raa-dropdown"
      role="listbox"
      [attr.aria-expanded]="true"
      (raaOutsideClick)="focusLost()"
      [includedElement]="raaSelect"
      class="raa-select-dropdown"
      [ngClass]="{ 'dropdown-is-above': dropdownIsAbove, 'dropdown-is-below': !dropdownIsAbove }"
    >
      <li *ngIf="filteredDomainValues.length === 0" role="option" class="raa-select-dropdown-item">
        <span>{{ noAvailableItemsText }}</span>
      </li>

      <li
        #dropdownItem
        *ngFor="let item of filteredDomainValues; let rowIndex = index"
        [id]="item.id.toString() + rowIndex"
        role="option"
        class="raa-select-dropdown-item"
        [attr.aria-selected]="item.id === value"
        (mouseover)="hoverIndex = rowIndex"
        (click)="select(item)"
        [ngClass]="{ selected: item.id === value, hovered: hoverIndex === rowIndex }"
      >
        <span>{{ item.displayValue }}</span>
      </li>
    </ul>
  </raa-dropdown>
</div>
